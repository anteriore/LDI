<style>
	.highlightred{
		background-color:red;
	}
</style>
<form novalidate ng-submit="$ctrl.submitForm();" method="post">
	<div class="form-content">
		<div class="step-form">
			<div class="horizontal-align -between">
				<div class="side-one">
					<div class="horizontal-align -between content">
						<div class="form-group field">
							<label class="label capitalize-text">PRF Number</label>
							<input type="text" readonly class="form-control -border" value="AUTOGENERATED UPON CREATION"/>
						</div>
					</div>
				</div>
				<div class="side-two">
					<div class="form-group">
						<div class="horizontal-align -between content">
							<div class="form-group field">
								<label class="label capitalize-text">Date</label>
								<input type="date" class="form-control -border" ng-model="$ctrl.prf.date"/>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="step-form">
			<div class="horizontal-align -between">
				<div class="side-one">
					<div class="horizontal-align -between content">
						<div class="form-group field">
							<label class="label capitalize-text">Date Needed</label>
							<input type="date" class="form-control -border" ng-model="$ctrl.prf.dateNeeded"/>
						</div>
					</div>
				</div>
				<div class="side-one">
					<div class="horizontal-align -between content">
						<div class="form-group field">
							<label class="label capitalize-text">Department</label>
							<input type="text" class="form-control -border" ng-model="$ctrl.prf.department.name"/>
						</div>
					</div>
				</div>
				<div class="side-two">
					<div class="form-group">
						<div class="horizontal-align -between content">
							<div class="form-group field">
								<label class="label capitalize-text">Requested By</label>
								<input type="hidden" ng-model="$ctrl.prf.requestedBy"/>
								<input type="text" class="form-control -border" readonly value="{{$ctrl.prf.requestedBy.firstName}} {{$ctrl.prf.requestedBy.lastName}}" />
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<table class='table table-list'>
        	<thead>
        		<tr>
        			<th>Type</th>
        			<th>Item Code</th>
		        	<th>Name</th>
		        	<th>Unit</th>
		        	<th>Current Stocks</th>
                    <th>Pending PRF</th>
                    <th>Pending PO</th>
                    <th>Quarantined</th>
                    <td>Required</td>
                    <th ng-if="$ctrl.engineering">MOQ</th>
                    <th>Lacking</th>
                    <th>Requested</th>
        		</tr>
        	</thead>
        	<tbody>
        		<tr ng-repeat="i in $ctrl.prf.requestedItems" ng-class="{highlightred: i.quantityLacking <= 0 }">
        			<td>
				  	<label class='custom-label -narrow' ng-class="{'-apple':i.item.type.code == 'RM', '-orangish':i.item.type.code =='PM', '-aqua': i.item.type.code == 'ENG' }">{{i.item.type.code}}</label>
				  </td>
        			<td ng-if="i.item.code !== undefined">{{i.item.code}}</td>
        			
        			<td ng-if="i.item.name !== undefined">{{i.item.name}}</td>
        		
        			<td ng-if="i.item.unit !== undefined">{{i.item.unit.code}}</td>
        			<td>{{i.stockOnHand}}</td>
        			<td>{{i.pendingPrf}}</td>
        			<td>{{i.pendingPo}}</td>
        			<td>{{i.pendingRr}}</td>
        			<td><input ng-change="$ctrl.computeTotalQuantity(item, i.quantityRequired, $index)" type="text" ng-model="i.quantityRequired"/></td>
        			<td ng-if="$ctrl.engineering"><input ng-change="$ctrl.computeTotalQuantity(item, i.quantityRequired, $index)" type="text" ng-model="i.moqQuantity"/></td>
        			<td>{{i.quantityLacking}}</td>
        			<td>{{i.quantityRequested}}</td>
        		</tr>
        	</tbody>
        </table>
        <div class="request-action">
			 <a href="#" class="button-link btn btn-action btn-md" ng-click="$ctrl.selectItem()" data-target="#findItemModal" data-toggle="modal">Select Item</a>
		</div>
		
		<div class="step-form">
			<div class="horizontal-align -between">
				<div class="side-one">
					<div class="horizontal-align -between content">
						<div class="form-group field">
							<label class="label capitalize-text">Remarks</label>
							<textarea type="text" class="form-control -border" ng-model="$ctrl.prf.remarks"></textarea>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="request-action">
			<button type="submit" class="btn btn-create btn-md">{{$ctrl.button}}</button>
		</div>
	</div>
</form>
	<find-item-modal
			itemlist="$ctrl.itemlist"
            message="{{ $ctrl.error }}"
			button="Select Item"
			on-submit="$ctrl.selectedItems($event);"
            >
    </find-item-modal>